# Social Media Content Analyzer & Scheduler - MVP

## ğŸ¯ Objective
Tool that analyzes social media posts and suggests optimized content/scheduling using AI agents.

---

## Database Structure
```sql
-- User/Social Media Account
CREATE TABLE social_accounts (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255) NOT NULL,
  platform VARCHAR(50) NOT NULL, -- twitter/instagram/linkedin
  created_at TIMESTAMP DEFAULT NOW()
);

-- Historical Posts
CREATE TABLE posts (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  social_account_id UUID REFERENCES social_accounts(id),
  content TEXT NOT NULL,
  topic VARCHAR(100), -- e.g., "promotions", "tips", "behind-the-scenes"
  published_at TIMESTAMP NOT NULL, -- when it was published
  scraped_at TIMESTAMP NOT NULL, -- 48hrs after published_at
  day_of_week VARCHAR(20), -- monday, tuesday, etc
  hour_of_day INTEGER, -- 14, 18, 20, etc
  likes_count INTEGER DEFAULT 0, -- total at 48hrs
  comments_count INTEGER DEFAULT 0,
  shares_count INTEGER DEFAULT 0,
  has_image BOOLEAN DEFAULT FALSE,
  has_video BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP DEFAULT NOW()
);

-- Analyses generated by the agent
CREATE TABLE analyses (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  social_account_id UUID REFERENCES social_accounts(id),
  text VARCHAR,
  insights JSONB, -- analysis findings
  suggestions JSONB, -- recommendations
  created_at TIMESTAMP DEFAULT NOW()
);
```

### Measurement Logic
- **Rule**: All posts are scraped exactly 48 hours after being published
- **scraped_at = published_at + 48 hours**
- This allows comparing "apples to apples": all posts measured at the same point in their lifecycle

Example:
```
Monday post at 14:00 â†’ scraped Wednesday 14:00 â†’ 1200 likes
Friday post at 14:00 â†’ scraped Sunday 14:00 â†’ 800 likes
Conclusion: Mondays have better performance
```

---

## ğŸ—ï¸ NestJS Architecture
```
src/
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ social-accounts/
â”‚   â”‚   â”œâ”€â”€ social-accounts.module.ts
â”‚   â”‚   â”œâ”€â”€ social-accounts.controller.ts
â”‚   â”‚   â”œâ”€â”€ social-accounts.service.ts
â”‚   â”‚   â””â”€â”€ entities/social-account.entity.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ posts/
â”‚   â”‚   â”œâ”€â”€ posts.module.ts
â”‚   â”‚   â”œâ”€â”€ posts.controller.ts
â”‚   â”‚   â”œâ”€â”€ posts.service.ts
â”‚   â”‚   â””â”€â”€ entities/post.entity.ts
â”‚   â”‚
â”‚   â””â”€â”€ ai-agent/
â”‚       â”œâ”€â”€ ai-agent.module.ts
â”‚       â”œâ”€â”€ ai-agent.controller.ts 
â”‚       â”œâ”€â”€ ai-agent.service.ts  (agent orchestration)
â”‚       â”œâ”€â”€ tools/
â”‚       â”‚   â”œâ”€â”€ analyze-performance.tool.ts
â”‚       â”‚   â”œâ”€â”€ generate-content.tool.ts
â”‚       â”‚   â””â”€â”€ suggest-schedule.tool.ts
â”‚       â””â”€â”€ dto/
â”‚           â””â”€â”€ analysis-request.dto.ts
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ ai.config.ts (API keys, model config)
â”‚
â””â”€â”€ database/
    â””â”€â”€ seeds/
        â””â”€â”€ posts.seed.ts (test data)
```

---

## ğŸ¤– AI Agent - Tools

### Tool 1: `analyzePostPerformance`

**Purpose**: Analyze engagement patterns in historical posts

**Input**:
```typescript
{
  socialAccountId: string;
  timePeriod: "30days" | "60days" | "90days";
}
```

**Output**:
```typescript
{
  bestDays: string[],  // ["monday", "wednesday"]
  bestHours: number[], // [14, 18]
  topTopics: [
    { topic: string, avgLikes: number },
    // e.g., { topic: "tips", avgLikes: 1200 }
  ],
  contentPatterns: {
    withImage: { avgLikes: number },
    withoutImage: { avgLikes: number }
  }
}
```

**Implementation**: Query the DB grouping by day_of_week, hour_of_day, topic, has_image, etc.

---

### Tool 2: `generateContentSuggestion`

**Purpose**: Generate optimized post draft based on historical data

**Input**:
```typescript
{
  topic: string;
  target_day: string;  // "monday"
  target_hour: number; // 14
}
```

**Output**:
```typescript
{
  suggestedContent: string, // "ğŸ¯ 3 tips for..."
  reasoning: string, // "Based on your previous 'tips' posts published on Mondays at 2pm..."
  expectedEngagement: string // "~1200 likes in 48hrs"
}
```

**Implementation**: The LLM uses historical data to generate content similar to what worked well previously.

---

### Tool 3: `suggestPostingSchedule`

**Purpose**: Suggest weekly posting calendar

**Input**:
```typescript
{
  posts_per_week: number; // 3
}
```

**Output**:
```typescript
{
  schedule: [
    { day: "monday", hour: 14, topic: "tips" },
    { day: "wednesday", hour: 18, topic: "behind-the-scenes" },
    { day: "friday", hour: 14, topic: "promos" }
  ]
}
```

**Implementation**: Combines best days/hours with rotation of well-performing topics.

---

## ğŸš€ Main Endpoints

### Create posts (for testing)
```http
POST /api/posts
Content-Type: application/json

{
  "socialAccountId": "uuid",
  "content": "5 tips to improve your productivity",
  "topic": "tips",
  "publishedAt": "2024-01-08T14:00:00Z",
  "scrapedAt": "2024-01-10T14:00:00Z",
  "dayOfWeek": "monday",
  "hourOfDay": 14,
  "likesCount": 1200,
  "commentsCount": 45,
  "hasImage": true
}
```

### Execute analysis with AI agent
```http
POST /api/analyze
Content-Type: application/json

{
  "socialAccountId": "uuid",
  "timePeriod": "30days"
}

Response:
{
  "insights": {
    "bestDays": ["monday", "wednesday"],
    "bestHours": [14, 18],
    "topTopics": [...]
  },
  "suggestions": {
    "nextPost": {...},
    "schedule": [...]
  }
}
```

### View previous analyses
```http
GET /api/analyses/:accountId

Response:
{
  "analyses": [
    {
      "id": "uuid",
      "insights": {...},
      "suggestions": {...},
      "created_at": "2024-01-15T10:00:00Z"
    }
  ]
}
```
---

## ğŸ› ï¸ Tech Stack

- **Backend**: NestJS
- **Database**: PostgreSQL
- **ORM**: TypeORM
- **AI SDK**: Vercel AI SDK
- **LLM**: Claude 4.5 Haiku (Anthropic)
- **Containerization**: Docker Compose
- **Frontend (optional)**: Next.js / React

---

## ğŸ“¦ Docker Compose Setup
```yaml
services:
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: social_analyzer
      POSTGRES_USER: dev
      POSTGRES_PASSWORD: dev123
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      DATABASE_URL: postgresql://dev:dev123@postgres:5432/social_analyzer
      ANTHROPIC_API_KEY: ${ANTHROPIC_API_KEY}
    depends_on:
      - postgres

volumes:
  postgres_data:
```

---

## ğŸ¯ Value of the service

### Demonstrates:
1. **AI Agents**: Not a simple chatbot, uses tools and orchestration
2. **Domain knowledge**: Social media data processing (relevant to the role)
3. **Backend skills**: NestJS, PostgreSQL, TypeORM, modular architecture
4. **Data analysis**: Aggregations, patterns, insights
5. **Scope management**: Functional MVP in 3-4 days

---

## ğŸ“ Seed Data Example
```typescript
// 50-100 varied posts for testing
const posts = [
  {
    content: "5 tips to improve your productivity",
    topic: "tips",
    published_at: new Date("2024-01-08T14:00:00Z"),
    scraped_at: new Date("2024-01-10T14:00:00Z"),
    day_of_week: "monday",
    hour_of_day: 14,
    likes_count: 1200,
    comments_count: 45,
    has_image: true
  },
  {
    content: "Special offer today! 20% discount",
    topic: "promos",
    published_at: new Date("2024-01-10T18:00:00Z"),
    scraped_at: new Date("2024-01-12T18:00:00Z"),
    day_of_week: "wednesday",
    hour_of_day: 18,
    likes_count: 800,
    comments_count: 30,
    has_image: true
  },
  // ... more varied posts
];

